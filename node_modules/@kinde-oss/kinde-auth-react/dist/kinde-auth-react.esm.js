import e,{createContext as n,useContext as r,useState as t,useReducer as o,useEffect as i,useCallback as u,useMemo as c}from"react";import a from"@kinde-oss/kinde-auth-pkce-js";var s=function(){return s=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},s.apply(this,arguments)};function l(e,n,r,t){return new(r||(r=Promise))((function(o,i){function u(e){try{a(t.next(e))}catch(e){i(e)}}function c(e){try{a(t.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?o(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(u,c)}a((t=t.apply(e,n||[])).next())}))}function f(e,n){var r,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(a){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(u=0)),u;)try{if(r=1,t&&(o=2&c[0]?t.return:c[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,c[1])).done)return o;switch(t=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return u.label++,{value:c[1],done:!1};case 5:u.label++,t=c[1],c=[0];continue;case 7:c=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){u=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){u.label=c[1];break}if(6===c[0]&&u.label<o[1]){u.label=o[1],o=c;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(c);break}o[2]&&u.ops.pop(),u.trys.pop();continue}c=n.call(e,u)}catch(e){c=[6,e],t=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}var d={isAuthenticated:!1,isLoading:!0},g=n(s({},d)),h=function(){var e=r(g);if(void 0===e)throw new Error("Oooops! useKindeAuth must be used within a KindeProvider");return e},p={INITIALISED:function(e,n){return s(s({},e),{isAuthenticated:Boolean(n.user),user:n.user,isLoading:!1,error:void 0})},LOGOUT:function(e){return s(s({},e),{isAuthenticated:!1,user:void 0})},ERROR:function(e,n){return s(s({},e),{isLoading:!1,error:n.error})}},v=function(e,n){return p[n.type]?p[n.type](e,n):e},y=function(){window.history.replaceState({},document.title,window.location.pathname)},b=function(n){var r=n.audience,h=n.scope,p=n.clientId,b=n.children,w=n.domain,m=n.isDangerouslyUseLocalStorage,O=void 0!==m&&m,k=n.redirectUri,I=n.onRedirectCallback,_=void 0===I?y:I,P=n.logoutUri,E=t(),L=E[0],R=E[1],U=o(v,d),x=U[0],A=U[1];i((function(){try{l(void 0,void 0,void 0,(function(){var e;return f(this,(function(n){switch(n.label){case 0:return[4,a({audience:r,scope:h,client_id:p,domain:w,is_dangerously_use_local_storage:O,redirect_uri:k,logout_uri:P,on_redirect_callback:_})];case 1:return e=n.sent(),R(e),[2]}}))}))}catch(e){console.error(e)}return function(){}}),[r,h,p,w,O,k,P]),i((function(){var e=!0;return function(){if(L&&e)try{var n=L.getUser();A({type:"INITIALISED",user:n})}catch(e){console.log(e),A({type:"ERROR",error:"login error"})}}(),function(){e=!1}}),[L]);var S=u((function(e){return L.login(e)}),[L]),T=u((function(e){return L.register(e)}),[L]),z=u((function(){return L.logout()}),[L]),j=u((function(e,n){return L.getClaim(e,n)}),[L]),C=u((function(){return L.getPermissions()}),[L]),D=u((function(e){return L.getPermission(e)}),[L]),G=u((function(){return L.getOrganization()}),[L]),K=u((function(){return L.getUserOrganizations()}),[L]),N=u((function(e){return L.createOrg(e)}),[L]),B=u((function(){return l(void 0,void 0,void 0,(function(){var e,n;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L.getToken()];case 1:return e=r.sent(),[3,3];case 2:throw n=r.sent(),console.error(n);case 3:return[2,e]}}))}))}),[L]),q=c((function(){return s(s({},x),{getToken:B,login:S,register:T,logout:z,createOrg:N,getClaim:j,getPermissions:C,getPermission:D,getOrganization:G,getUserOrganizations:K})}),[x,B,S,T,z,N,j,C,D,G,K]);return e.createElement(g.Provider,{value:q},b)};export{b as KindeProvider,h as useKindeAuth};
//# sourceMappingURL=kinde-auth-react.esm.js.map
